(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a089fe48"],{"7e4b":function(t,a,s){"use strict";s.r(a);var e=function(){var t=this,a=t._self._c;return a("div",{staticClass:"generate-cards"},[t._m(0),a("div",{staticClass:"generate-form"},[a("div",{staticClass:"form-group"},[a("label",[t._v("充值金额")]),a("div",{staticClass:"amount-input"},[a("span",{staticClass:"currency"},[t._v("¥")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.amount,expression:"form.amount"}],attrs:{type:"number",min:"0",step:"0.01",placeholder:"请输入充值金额"},domProps:{value:t.form.amount},on:{input:function(a){a.target.composing||t.$set(t.form,"amount",a.target.value)}}})])]),a("div",{staticClass:"form-group"},[a("label",[t._v("生成数量")]),a("div",{staticClass:"count-input"},[a("button",{staticClass:"count-btn",attrs:{disabled:t.form.count<=1},on:{click:t.decreaseCount}},[a("i",{staticClass:"fas fa-minus"})]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.count,expression:"form.count"}],attrs:{type:"number",min:"1",max:"100",placeholder:"请输入生成数量（最多100个）"},domProps:{value:t.form.count},on:{input:function(a){a.target.composing||t.$set(t.form,"count",a.target.value)}}}),a("button",{staticClass:"count-btn",attrs:{disabled:t.form.count>=100},on:{click:t.increaseCount}},[a("i",{staticClass:"fas fa-plus"})])])]),a("button",{staticClass:"generate-btn",attrs:{disabled:!t.isFormValid||t.loading},on:{click:t.generateCards}},[a("i",{staticClass:"fas fa-plus-circle"}),t._v(" "+t._s(t.loading?"生成中...":"生成卡密")+" ")])]),t.generatedCards.length>0?a("div",{staticClass:"result-section"},[a("div",{staticClass:"result-header"},[a("h3",[t._v("生成结果")]),a("button",{staticClass:"export-btn",on:{click:t.exportToExcel}},[a("i",{staticClass:"fas fa-file-export"}),t._v(" 导出Excel ")])]),a("div",{staticClass:"cards-grid"},t._l(t.generatedCards,(function(s){return a("div",{key:s.cardNo,staticClass:"card-item"},[a("div",{staticClass:"card-header"},[a("span",{staticClass:"card-label"},[t._v("卡号")]),a("button",{staticClass:"copy-btn",on:{click:function(a){return t.copyCardNo(s.cardNo)}}},[a("i",{staticClass:"fas fa-copy"})])]),a("div",{staticClass:"card-no"},[t._v(t._s(s.cardNo))]),a("div",{staticClass:"card-info"},[a("span",[t._v("金额: ¥"+t._s(t.formatAmount(s.amount)))]),a("span",[t._v("状态: "+t._s("unused"===s.status?"未使用":"已使用"))])])])})),0)]):t._e()])},o=[function(){var t=this,a=t._self._c;return a("div",{staticClass:"header"},[a("h2",[t._v("卡密生成")])])}],r=(s("14d9"),s("a573"),s("88a7"),s("271a"),s("5494"),{name:"GenerateCards",data(){return{form:{amount:"",count:1},loading:!1,generatedCards:[]}},computed:{isFormValid(){const t=parseFloat(this.form.amount),a=parseInt(this.form.count);return t>0&&a>0&&a<=100}},methods:{formatAmount(t){return parseFloat(t).toFixed(2)},increaseCount(){this.form.count<100&&this.form.count++},decreaseCount(){this.form.count>1&&this.form.count--},async generateCards(){if(this.isFormValid&&!this.loading)try{this.loading=!0;const t=await this.$api.post("/api/recharge-cards",this.form);this.generatedCards=t.data.cards,this.$message.success("卡密生成成功")}catch(s){var t,a;this.$message.error((null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"生成卡密失败")}finally{this.loading=!1}},copyCardNo(t){navigator.clipboard.writeText(t).then(()=>{this.$message.success("卡号已复制")}).catch(()=>{this.$message.error("复制失败")})},exportToExcel(){const t=[["卡号","金额","状态","生成时间"].join(","),...this.generatedCards.map(t=>[t.cardNo,this.formatAmount(t.amount),"unused"===t.status?"未使用":"已使用",new Date(t.createdAt).toLocaleString()].join(","))].join("\n"),a=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),e=URL.createObjectURL(a);s.setAttribute("href",e),s.setAttribute("download",`卡密列表_${(new Date).toLocaleDateString()}.csv`),document.body.appendChild(s),s.click(),document.body.removeChild(s)}},created(){const t=localStorage.getItem("userRole");"superadmin"!==t&&(this.$router.push("/channel-market"),this.$message.error("权限不足"))}}),n=r,i=(s("dbac"),s("2877")),c=Object(i["a"])(n,e,o,!1,null,"7f015755",null);a["default"]=c.exports},c464:function(t,a,s){},dbac:function(t,a,s){"use strict";s("c464")}}]);
//# sourceMappingURL=chunk-a089fe48.d30d739c.js.map