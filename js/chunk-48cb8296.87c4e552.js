(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48cb8296"],{"06cb":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t._self._c;return s("div",{staticClass:"invite-codes"},[t._m(0),s("div",{staticClass:"generate-form"},[s("div",{staticClass:"form-group"},[s("label",[t._v("生成数量")]),s("div",{staticClass:"count-input"},[s("button",{staticClass:"count-btn",attrs:{disabled:t.form.count<=1},on:{click:t.decreaseCount}},[s("i",{staticClass:"fas fa-minus"})]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.count,expression:"form.count"}],attrs:{type:"number",min:"1",max:"100",placeholder:"请输入生成数量（最多100个）"},domProps:{value:t.form.count},on:{input:function(s){s.target.composing||t.$set(t.form,"count",s.target.value)}}}),s("button",{staticClass:"count-btn",attrs:{disabled:t.form.count>=100},on:{click:t.increaseCount}},[s("i",{staticClass:"fas fa-plus"})])])]),s("button",{staticClass:"generate-btn",attrs:{disabled:!t.isFormValid||t.loading},on:{click:t.generateCodes}},[s("i",{staticClass:"fas fa-plus-circle"}),t._v(" "+t._s(t.loading?"生成中...":"生成邀请码")+" ")])]),s("div",{staticClass:"codes-section"},[t.isMobile?s("div",{staticClass:"mobile-cards"},t._l(t.codes,(function(e){var a;return s("div",{key:e._id,staticClass:"code-card"},[s("div",{staticClass:"card-header"},[s("div",{staticClass:"code-no"},[t._v(" "+t._s(e.code)+" "),s("button",{staticClass:"copy-btn",on:{click:function(s){return t.copyCode(e.code)}}},[s("i",{staticClass:"fas fa-copy"})])]),s("span",{class:["status-badge","used"===e.status?"used":"unused"]},[t._v(" "+t._s("used"===e.status?"已使用":"未使用")+" ")])]),s("div",{staticClass:"card-body"},[s("div",{staticClass:"info-row"},[s("span",{staticClass:"label"},[t._v("创建时间:")]),s("span",{staticClass:"value"},[t._v(t._s(t.formatDate(e.createdAt)))])]),s("div",{staticClass:"info-row"},[s("span",{staticClass:"label"},[t._v("使用时间:")]),s("span",{staticClass:"value"},[t._v(t._s(e.usedAt?t.formatDate(e.usedAt):"-"))])]),s("div",{staticClass:"info-row"},[s("span",{staticClass:"label"},[t._v("使用者:")]),s("span",{staticClass:"value"},[t._v(t._s((null===(a=e.usedBy)||void 0===a?void 0:a.username)||"-"))])])]),s("div",{staticClass:"card-footer"},[s("button",{staticClass:"delete-btn",attrs:{disabled:"used"===e.status},on:{click:function(s){return t.deleteCode(e)}}},[s("i",{staticClass:"fas fa-trash-alt"}),t._v(" 删除 ")])])])})),0):s("div",{staticClass:"table-wrapper"},[s("table",[t._m(1),s("tbody",t._l(t.codes,(function(e){var a;return s("tr",{key:e._id},[s("td",[s("div",{staticClass:"code-no"},[t._v(" "+t._s(e.code)+" "),s("button",{staticClass:"copy-btn",on:{click:function(s){return t.copyCode(e.code)}}},[s("i",{staticClass:"fas fa-copy"})])])]),s("td",[s("span",{class:["status-badge","used"===e.status?"used":"unused"]},[t._v(" "+t._s("used"===e.status?"已使用":"未使用")+" ")])]),s("td",[t._v(t._s(t.formatDate(e.createdAt)))]),s("td",[t._v(t._s(e.usedAt?t.formatDate(e.usedAt):"-"))]),s("td",[t._v(t._s((null===(a=e.usedBy)||void 0===a?void 0:a.username)||"-"))]),s("td",[s("button",{staticClass:"delete-btn",attrs:{disabled:"used"===e.status},on:{click:function(s){return t.deleteCode(e)}}},[s("i",{staticClass:"fas fa-trash-alt"}),t._v(" 删除 ")])])])})),0)])]),0===t.codes.length?s("div",{staticClass:"empty-state"},[s("i",{staticClass:"fas fa-ticket-alt"}),s("p",[t._v("暂无邀请码数据")])]):t._e()]),t.showDeleteModal?s("div",{staticClass:"modal-overlay",on:{click:t.closeDeleteModal}},[s("div",{staticClass:"delete-modal",on:{click:function(t){t.stopPropagation()}}},[s("div",{staticClass:"modal-header"},[t._m(2),s("button",{staticClass:"close-btn",on:{click:t.closeDeleteModal}},[s("i",{staticClass:"fas fa-times"})])]),t._m(3),s("div",{staticClass:"modal-footer"},[s("button",{staticClass:"cancel-btn",on:{click:t.closeDeleteModal}},[s("i",{staticClass:"fas fa-times"}),t._v(" 取消 ")]),s("button",{staticClass:"confirm-btn danger",attrs:{disabled:t.deleteLoading},on:{click:t.confirmDelete}},[s("i",{staticClass:"fas fa-trash-alt"}),t._v(" "+t._s(t.deleteLoading?"删除中...":"确认删除")+" ")])])])]):t._e()])},i=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"header"},[s("h2",[t._v("邀请码管理")])])},function(){var t=this,s=t._self._c;return s("thead",[s("tr",[s("th",[t._v("邀请码")]),s("th",[t._v("状态")]),s("th",[t._v("创建时间")]),s("th",[t._v("使用时间")]),s("th",[t._v("使用者")]),s("th",[t._v("操作")])])])},function(){var t=this,s=t._self._c;return s("h3",[s("i",{staticClass:"fas fa-exclamation-triangle"}),t._v(" 确认删除 ")])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"modal-content"},[s("div",{staticClass:"warning-text"},[s("i",{staticClass:"fas fa-exclamation-circle"}),s("span",[t._v("确定要删除此邀请码吗？")])]),s("p",{staticClass:"sub-warning"},[t._v("此操作不可恢复，请谨慎操作。")])])}],o=(e("0643"),e("2382"),{name:"InviteCodes",data(){return{form:{count:1},codes:[],loading:!1,isMobile:!1,showDeleteModal:!1,deleteLoading:!1,codeToDelete:null}},computed:{isFormValid(){const t=parseInt(this.form.count);return t>0&&t<=100}},methods:{formatDate(t){return new Date(t).toLocaleString()},increaseCount(){this.form.count<100&&this.form.count++},decreaseCount(){this.form.count>1&&this.form.count--},async generateCodes(){if(this.isFormValid&&!this.loading)try{this.loading=!0;const t=await this.$api.post("/api/invite-codes",this.form);this.codes=[...t.data.codes,...this.codes],this.$message.success("邀请码生成成功")}catch(e){var t,s;this.$message.error((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"生成邀请码失败")}finally{this.loading=!1}},async loadCodes(){try{const t=await this.$api.get("/api/invite-codes");this.codes=t.data.codes}catch(t){this.$message.error("获取邀请码列表失败")}},copyCode(t){navigator.clipboard.writeText(t).then(()=>{this.$message.success("邀请码已复制")}).catch(()=>{this.$message.error("复制失败")})},deleteCode(t){"used"!==t.status?(this.codeToDelete=t,this.showDeleteModal=!0):this.$message.error("已使用的邀请码不能删除")},closeDeleteModal(){this.showDeleteModal=!1,this.codeToDelete=null},async confirmDelete(){if(this.codeToDelete)try{this.deleteLoading=!0;const t=await this.$api.delete("/api/invite-codes/"+this.codeToDelete._id);"删除成功"===t.data.message&&(this.codes=this.codes.filter(t=>t._id!==this.codeToDelete._id),this.$message.success("删除成功"),this.closeDeleteModal())}catch(t){this.$message.error(t.message||"删除失败")}finally{this.deleteLoading=!1}},checkMobile(){this.isMobile=window.innerWidth<=768}},created(){this.checkMobile(),window.addEventListener("resize",this.checkMobile),this.loadCodes()},beforeDestroy(){window.removeEventListener("resize",this.checkMobile)}}),c=o,l=(e("4780"),e("2877")),n=Object(l["a"])(c,a,i,!1,null,"92c124d4",null);s["default"]=n.exports},4780:function(t,s,e){"use strict";e("4d63")},"4d63":function(t,s,e){}}]);
//# sourceMappingURL=chunk-48cb8296.87c4e552.js.map